<div class="container my-5">
  <!-- En-tête du Profil -->
  <div class="card shadow-sm border-0 rounded mb-4">
    <div class="card-body d-flex align-items-center">
      <div>
        <h2 class="mb-1">{{ member?.personalInfo?.firstname }} {{ member?.personalInfo?.name }}</h2>
        <p class="text-muted mb-0">{{ member?.membershipInfo?.legacyInstitution }}</p>
        <p class="text-muted">{{ member?.addressInfo?.addressInDakar }}</p>
      </div>
    </div>
  </div>

  <div class="accordion" id="profileAccordion">
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button
          class="accordion-button"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#personalInfo"
        >
          Résumé
        </button>
      </h2>
      <div id="personalInfo" class="accordion-collapse collapse show show">
        <div class="accordion-body">
          <div *ngIf="!isPersonalInfoEditing; else editPersonalInfo">
            <div class="row">
              <div class="col-md-6">
                <p><strong>Prénom :</strong> {{ member?.personalInfo?.firstname }}</p>
                <p><strong>Adresse e-mail :</strong> {{ member?.contactInfo?.email }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Nom :</strong> {{ member?.personalInfo?.name }}</p>
                <p><strong>Téléphone :</strong> {{ member?.contactInfo?.numberPhone }}</p>
              </div>
            </div>
            <button class="btn btn-outline-primary mt-3" (click)="togglePersonalInfoInfo()">
              <i class="bi bi-pencil"></i> Modifier
            </button>
          </div>
          <ng-template #editPersonalInfo>
            <form [formGroup]="personalInfo" novalidate (ngSubmit)="onPersonalInfoChangeSave()">
              <!-- Personal Info Section -->
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="mb-0 text-center">Informations personnelles</h5>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="name" class="form-label">Nom</label>
                        <input
                          type="text"
                          id="name"
                          formControlName="name"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': personalInfo.get('name')?.invalid && personalInfo.get('name')?.touched }"
                          placeholder="Entrez votre nom"
                        />
                        <div
                          *ngIf="personalInfo.get('name')?.invalid && personalInfo.get('name')?.touched"
                          class="invalid-feedback">
                          Le nom est requis et doit comporter au moins 2 caractères.
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="firstname" class="form-label">Prénom</label>
                        <input
                          type="text"
                          id="firstname"
                          formControlName="firstname"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': personalInfo.get('firstname')?.invalid && personalInfo.get('firstname')?.touched }"
                          placeholder="Entrez votre prénom"
                        />
                        <div
                          *ngIf="personalInfo.get('firstname')?.invalid && personalInfo.get('firstname')?.touched"
                          class="invalid-feedback">
                          Le prénom est requis et doit comporter au moins 2 caractères.
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="nationality" class="form-label">Nationalité</label>
                        <input
                          type="text"
                          id="nationality"
                          formControlName="nationality"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': personalInfo.get('nationality')?.invalid && personalInfo.get('nationality')?.touched }"
                          placeholder="Entrez votre nationalité"
                        />
                        <div
                          *ngIf="personalInfo.get('nationality')?.invalid && personalInfo.get('nationality')?.touched"
                          class="invalid-feedback">
                          La nationalité est requise.
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="birthday" class="form-label">Date de naissance</label>
                        <input
                          type="date"
                          id="birthday"
                          formControlName="birthday"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': personalInfo.get('birthday')?.invalid && personalInfo.get('birthday')?.touched }"
                          [max]="maxDate"
                        />
                        <div
                          *ngIf="personalInfo.get('birthday')?.invalid && personalInfo.get('birthday')?.touched"
                          class="invalid-feedback">
                          La date de naissance est requise.
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="maritalStatus" class="form-label">Situation Matrimoniale</label>
                    <select id="maritalStatus" formControlName="maritalStatus" class="form-control">
                      <option value="" [defaultSelected]="1==1" disabled>Sélectionnez</option>
                      <option value="{{member.personalInfo.maritalStatus}}">Célibataire</option>
                      <option value="{{member.personalInfo.maritalStatus}}">Marié</option>
                    </select>
                    <div
                      *ngIf="personalInfo.get('maritalStatus')?.invalid && personalInfo.get('maritalStatus')?.touched"
                      class="invalid-feedback">
                      L'état civil est requis.
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-grid gap-2 mt-4">
                <div class="row justify-content-end">
                  <div class="col-auto">
                  </div>
                  <div class="d-flex justify-content-end mt-3">
                    <button [disabled]="!this.memberForm.get('personalInfo')?.dirty" class="btn btn-outline-success me-2">Enregistrer</button>
                    <button class="btn btn-outline-secondary" (click)="togglePersonalInfoInfo()">Annuler</button>
                  </div>
                </div>
              </div>
            </form>

          </ng-template>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button
          class="accordion-button collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#membershipInfo"
        >
          Informations d'Adhésion
        </button>
      </h2>
      <div id="membershipInfo" class="accordion-collapse collapse show">
        <div class="accordion-body">
          <div *ngIf="!isEditingMembershipInfo; else editMembershipInfo">
            <div class="row">
              <div class="col-md-6">
                <p><strong>Lycée de provenance :</strong> {{ member?.membershipInfo?.legacyInstitution }}</p>
                <p><strong>Année d'obtention du Bac :</strong> {{ member?.membershipInfo?.yearOfBac }}</p>
                <p><strong>Série au Bac :</strong> {{ member?.membershipInfo?.bacSeries }}</p>
                <p><strong>Mention au Bac :</strong> {{ member?.membershipInfo?.bacMention }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Cours AEMUD suivis :</strong> {{ member.membershipInfo.aemudCourses }}</p>
                <p><strong>Autres cours suivis :</strong> {{ member.membershipInfo.otherCourses }}</p>
                <p><strong>Activités AEMUD :</strong> {{ member.membershipInfo.participatedActivity }}</p>
                <p><strong>Parti politique :</strong> {{ member.membershipInfo.politicOrganisation }}</p>
              </div>
            </div>
            <button class="btn btn-outline-primary mt-3" (click)="toggleEditMembershipInfo()">
              <i class="bi bi-pencil"></i> Modifier
            </button>
          </div>
        </div>
        <ng-template #editMembershipInfo>
          <div class="container mt-2">
            <form [formGroup]="membershipInfo" (ngSubmit)="onMembershipInfoSave()" novalidate>
              <div class="card mb-4">
                <div class="card-body">
                  <div class="mb-3">
                    <label for="yearOfBac" class="form-label">Année de bac</label>
                    <input
                      id="yearOfBac"
                      formControlName="yearOfBac"
                      class="form-control"
                      [ngClass]="{ 'is-invalid': membershipInfo.get('yearOfBac')?.invalid && membershipInfo.get('yearOfBac')?.touched }"
                      placeholder="Entrez l'année d'obtention du bac"
                    />
                    <div
                      *ngIf="membershipInfo.get('yearOfBac')?.invalid && membershipInfo.get('yearOfBac')?.touched"
                      class="invalid-feedback">
                      L'année d'obtention du bac est requise.
                    </div>
                  </div>
                  <div class="mb-3">
                    <label for="bacSeries" class="form-label">BAC: Série</label>
                    <select
                      id="bacSeries"
                      formControlName="bacSeries"
                      class="form-control"
                      [ngClass]="{ 'is-invalid': membershipInfo.get('bacSeries')?.invalid && membershipInfo.get('bacSeries')?.touched }"
                    >
                      <option [defaultSelected]="1==1" value="" disabled selected>-- Sélectionnez votre série --
                      </option>
                      <option value="S1">Série S1</option>
                      <option value="S2">Série S2</option>
                      <option value="S3">Série S3</option>
                      <option value="L1">Série L'1</option>
                      <option value="L2">Série L2</option>
                      <option value="Technique">Technique</option>
                      <option value="G">Série G</option>
                    </select>
                    <div
                      *ngIf="membershipInfo.get('bacSeries')?.invalid && membershipInfo.get('bacSeries')?.touched"
                      class="invalid-feedback"
                    >
                      Veuillez sélectionner une série valide pour votre BAC.
                    </div>

                    <div
                      *ngIf="membershipInfo.get('bacSeries')?.invalid && membershipInfo.get('bacSeries')?.touched"
                      class="invalid-feedback">
                      La série au bac
                    </div>
                    <div class="mb-3">
                      <label for="bacMention" class="form-label">BAC: Mention</label>
                      <select
                        id="bacMention"
                        formControlName="bacMention"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('bacMention')?.invalid && membershipInfo.get('bacMention')?.touched }"
                      >
                        <option value="" disabled selected>-- Sélectionnez votre mention --</option>
                        <option value="Très Bien">Très Bien</option>
                        <option value="Bien">Bien</option>
                        <option value="Assez Bien">Assez Bien</option>
                        <option value="Passable">Passable</option>
                        <option value="Sans Mention">Sans Mention</option>
                      </select>
                      <div
                        *ngIf="membershipInfo.get('bacMention')?.invalid && membershipInfo.get('bacMention')?.touched"
                        class="invalid-feedback"
                      >
                        Veuillez sélectionner une mention valide pour votre BAC.
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="legacyInstitution" class="form-label">Etablissement d'origine</label>
                      <input
                        id="legacyInstitution"
                        formControlName="legacyInstitution"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('legacyInstitution')?.invalid && membershipInfo.get('legacyInstitution')?.touched }"
                        placeholder="Entrez la mention au BAC"
                      />
                      <div
                        *ngIf="membershipInfo.get('legacyInstitution')?.invalid && membershipInfo.get('legacyInstitution')?.touched"
                        class="invalid-feedback">
                        L'Etablissement d'origine est obligatoire
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="aemudCourses" class="form-label">Cours AEMUD</label>
                      <input
                        type="text"
                        id="aemudCourses"
                        formControlName="aemudCourses"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('aemudCourses')?.invalid && membershipInfo.get('aemudCourses')?.touched }"
                        placeholder="Entrez les cours AEMUD"
                      />
                      <div
                        *ngIf="membershipInfo.get('aemudCourses')?.invalid && membershipInfo.get('aemudCourses')?.touched"
                        class="invalid-feedback">
                        Les cours AEMUD sont requis.
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="otherCourses" class="form-label">Avez-vous suivi d'autres cours ? </label>
                      <input
                        type="text"
                        id="otherCourses"
                        formControlName="otherCourses"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('otherCourses')?.invalid && membershipInfo.get('otherCourses')?.touched }"
                        placeholder="Entrez d'autres cours"
                      />
                      <div
                        *ngIf="membershipInfo.get('otherCourses')?.invalid && membershipInfo.get('otherCourses')?.touched"
                        class="invalid-feedback">
                        Les autres cours sont requis.
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="participatedActivity" class="form-label">Activité Participée</label>
                      <input
                        type="text"
                        id="participatedActivity"
                        formControlName="participatedActivity"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('participatedActivity')?.invalid && membershipInfo.get('participatedActivity')?.touched }"
                        placeholder="Entrez l'activité participée"
                      />
                      <div
                        *ngIf="membershipInfo.get('participatedActivity')?.invalid && membershipInfo.get('participatedActivity')?.touched"
                        class="invalid-feedback">
                        L'activité est requise.
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="politicOrganisation" class="form-label">Organisation Politique</label>
                      <input
                        type="text"
                        id="politicOrganisation"
                        formControlName="politicOrganisation"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': membershipInfo.get('politicOrganisation')?.invalid && membershipInfo.get('politicOrganisation')?.touched }"
                        placeholder="Entrez l'organisation politique"
                      />
                      <div
                        *ngIf="membershipInfo.get('politicOrganisation')?.invalid && membershipInfo.get('politicOrganisation')?.touched"
                        class="invalid-feedback">
                        L'organisation politique est requise.
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="commission" class="form-label">Commission</label>
                      <select id="commission" formControlName="commission" class="form-control">
                        <option value="" [defaultSelected]="1==1" disabled>Sélectionnez une commission</option>
                        <option *ngFor="let commission of commissions" value="{{commission.id}}">{{ commission.name }}
                        </option>
                      </select>
                      <div
                        *ngIf="membershipInfo.get('commission')?.invalid && membershipInfo.get('commission')?.touched"
                        class="invalid-feedback">
                        La commission est requise.
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="clubs" class="form-label">Clubs</label>
                      <select id="clubs" formControlName="clubs" class="form-control">
                        <option value="" [defaultSelected]="1==1" disabled>Sélectionnez un club</option>
                        <option *ngFor="let club of clubs" value="{{club.id}}">{{ club.name }}</option>
                      </select>
                      <div
                        *ngIf="membershipInfo.get('clubs')?.invalid && membershipInfo.get('clubs')?.touched"
                        class="invalid-feedback">
                        Le club est requis.
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="bourse" class="form-label">Bourse</label>
                      <select id="bourse" formControlName="bourse" class="form-control">
                        <option value="" [defaultSelected]="1==1" disabled>Sélectionnez une bourse</option>
                        <option *ngFor="let bourse of bourses" value="{{bourse.bourseId}}">{{ bourse.lebelle }}</option>
                      </select>
                      <div
                        *ngIf="membershipInfo.get('bourse')?.invalid && membershipInfo.get('bourse')?.touched"
                        class="invalid-feedback">
                        La bourse est requise.
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-grid gap-2 mt-4">
                <div class="row justify-content-end">
                  <div class="col-auto">
                  </div>
                  <div class="d-flex justify-content-end mt-3">
                    <button class="btn btn-outline-success me-2">Enregistrer</button>
                    <button class="btn btn-outline-secondary" (click)="toggleEditMembershipInfo()">Annuler</button>
                  </div>
                </div>
              </div>
            </form>
          </div>

        </ng-template>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button
          class="accordion-button collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#academicInfo"
        >
          Informations Académiques
        </button>
      </h2>
      <div id="academicInfo" class="accordion-collapse collapse show">
        <div class="accordion-body">
          <div *ngIf="!isEditingAcademicInfo; else  editAcademicInfo">
            <div class="row">
              <div class="col-md-6">
                <p><strong>Université/Institut :</strong> {{ member?.academicInfo?.institutionName }}</p>
                <p><strong>Domaine d'études :</strong> {{ member?.academicInfo?.studiesDomain }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Niveau d'étude :</strong> {{ member?.academicInfo?.studiesLevel }}</p>
              </div>
            </div>
            <button (click)="toggleEditingAcademicInfo()" class="btn btn-outline-primary mt-3">
              <i class="bi bi-pencil"></i> Modifier
            </button>
          </div>
        </div>
        <ng-template #editAcademicInfo>
          <form [formGroup]="academicInfo" (ngSubmit)="onAcademyInfoSaved()" novalidate>
            <div class="card shadow-sm border-0 mb-4">
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="studiesLevel" class="form-label">Niveau d'étude</label>
                      <input
                        type="text"
                        id="studiesLevel"
                        formControlName="studiesLevel"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': academicInfo.get('studiesLevel')?.invalid && academicInfo.get('studiesLevel')?.touched }"
                        placeholder="Entrez le niveau d'étude"
                      />
                      <div
                        *ngIf="academicInfo.get('studiesLevel')?.invalid && academicInfo.get('studiesLevel')?.touched"
                        class="invalid-feedback">
                        Le niveau d'étude est requis.
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="institutionName" class="form-label">Université</label>
                      <input
                        type="text"
                        id="institutionName"
                        formControlName="institutionName"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': academicInfo.get('institutionName')?.invalid && academicInfo.get('institutionName')?.touched }"
                        placeholder="Nom de l'université"
                      />
                      <div
                        *ngIf="academicInfo.get('institutionName')?.invalid && academicInfo.get('institutionName')?.touched"
                        class="invalid-feedback">
                        Le nom de l'université est requis et doit comporter au moins 3 caractères.
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="mb-3">
                      <label for="studiesDomain" class="form-label">Domaine d'études</label>
                      <input
                        type="text"
                        id="studiesDomain"
                        formControlName="studiesDomain"
                        class="form-control"
                        [ngClass]="{ 'is-invalid': academicInfo.get('studiesDomain')?.invalid && academicInfo.get('studiesDomain')?.touched }"
                        placeholder="Entrez le domaine d'études"
                      />
                      <div
                        *ngIf="academicInfo.get('studiesDomain')?.invalid && academicInfo.get('studiesDomain')?.touched"
                        class="invalid-feedback">
                        Le domaine d'études est requis et doit comporter au moins 3 caractères.
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="d-grid gap-2 mt-4">
              <div class="row justify-content-end">
                <div class="col-auto">
                </div>
                <div class="d-flex justify-content-end mt-3">
                  <button class="btn btn-outline-success me-2">Enregistrer</button>
                  <button class="btn btn-outline-secondary" (click)="toggleEditMembershipInfo()">Annuler</button>
                </div>
              </div>
            </div>
          </form>
        </ng-template>

      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header">
        <button
          class="accordion-button collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#emergencyContact"
        >
          Contact d'Urgence
        </button>
      </h2>
      <div id="emergencyContact" class="accordion-collapse collapse show">
        <div class="accordion-body">
          <div *ngIf="!isEditingContactInfo; else editContactInfo">
            <div *ngFor="let p of member?.contactInfo?.personToCalls" class="mb-3">
              <p><strong>Relation :</strong> {{ p.relationship }}</p>
              <p><strong>Nom complet :</strong> {{ p.firstname }} {{ p.lastname }}</p>
              <p><strong>Téléphone principal :</strong> {{ p.requiredNumberPhone }}</p>
              <p><strong>Téléphone secondaire :</strong> {{ p.optionalNumberPhone }}</p>
            </div>
            <button (click)="toggleEditingContactInfo()" class="btn btn-outline-primary mt-3">
              <i class="bi bi-pencil"></i> Modifier
            </button>
          </div>
          <ng-template #editContactInfo>
            <form [formGroup]="contactInfo" (ngSubmit)="onContactInfoSaved()">
              <!-- Member Info Section -->
              <div class="card mb-4">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="numberPhone" class="form-label">Numéro de Téléphone</label>
                        <input
                          type="text"
                          id="numberPhone"
                          formControlName="numberPhone"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': contactInfo.get('numberPhone')?.invalid && contactInfo.get('numberPhone')?.touched }"
                          placeholder="+221XXXXXXXXX"
                        />
                        <div *ngIf="contactInfo.get('numberPhone')?.invalid && contactInfo.get('numberPhone')?.touched"
                             class="invalid-feedback">
                          Numéro de téléphone invalide. Format requis : +221XXXXXXXXX.
                        </div>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="mb-3">
                        <label for="email" class="form-label">Adresse Email</label>
                        <input
                          type="email"
                          id="email"
                          formControlName="email"
                          class="form-control"
                          [ngClass]="{ 'is-invalid': contactInfo.get('email')?.invalid && contactInfo.get('email')?.touched }"
                          placeholder="Entrez l'adresse email"
                        />
                        <div *ngIf="contactInfo.get('email')?.invalid && contactInfo.get('email')?.touched"
                             class="invalid-feedback">
                          Adresse email invalide.
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Person To Call Section -->
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="mb-0">Personnes à Contacter</h5>
                </div>
                <div class="card-body">
                  <div *ngIf="personToCalls.controls.length > 0">
                    <div formArrayName="personToCalls">
                      <div *ngFor="let person of personToCalls.controls; let i = index;" [formGroupName]="i"
                           class="mb-4">
                        <div class="row">
                          <div class="col-md-6">
                            <label for="lastname{{ i }}" class="form-label">Nom</label>
                            <input
                              type="text"
                              id="lastname{{ i }}"
                              formControlName="lastname"
                              class="form-control"
                              [ngClass]="{ 'is-invalid': person.get('lastname')?.invalid && person.get('lastname')?.touched }"
                              placeholder="Entrez le nom"
                            />
                            <div *ngIf="person.get('lastname')?.invalid && person.get('lastname')?.touched"
                                 class="invalid-feedback">
                              Nom requis.
                            </div>
                          </div>

                          <div class="col-md-6">
                            <label for="firstname{{ i }}" class="form-label">Prénom</label>
                            <input
                              type="text"
                              id="firstname{{ i }}"
                              formControlName="firstname"
                              class="form-control"
                              [ngClass]="{ 'is-invalid': person.get('firstname')?.invalid && person.get('firstname')?.touched }"
                              placeholder="Entrez le prénom"
                            />
                            <div *ngIf="person.get('firstname')?.invalid && person.get('firstname')?.touched"
                                 class="invalid-feedback">
                              Prénom requis.
                            </div>
                          </div>
                        </div>
                        <div class="row mt-3">
                          <div class="col-md-6">
                            <label for="requiredNumberPhone{{ i }}" class="form-label">Téléphone Principal</label>
                            <input
                              type="text"
                              id="requiredNumberPhone{{ i }}"
                              formControlName="requiredNumberPhone"
                              class="form-control"
                              [ngClass]="{ 'is-invalid': person.get('requiredNumberPhone')?.invalid && person.get('requiredNumberPhone')?.touched }"
                              placeholder="+221XXXXXXXXX"
                            />
                            <div
                              *ngIf="person.get('requiredNumberPhone')?.invalid && person.get('requiredNumberPhone')?.touched"
                              class="invalid-feedback">
                              Téléphone principal invalide. Format requis : +221XXXXXXXXX.
                            </div>
                          </div>

                          <div class="col-md-6">
                            <label for="optionalNumberPhone{{ i }}" class="form-label">Téléphone Secondaire</label>
                            <input
                              type="text"
                              id="optionalNumberPhone{{ i }}"
                              formControlName="optionalNumberPhone"
                              class="form-control"
                              placeholder="+221XXXXXXXXX"
                            />
                          </div>
                        </div>

                        <div class="row mt-3">
                          <div class="col-md-6">
                            <label for="relationship{{ i }}" class="form-label">Relation</label>
                            <input
                              type="text"
                              id="relationship{{ i }}"
                              formControlName="relationship"
                              class="form-control"
                              placeholder="Entrez la relation"
                            />
                          </div>

                          <div class="col-md-6">
                            <button type="button" class="btn btn-danger mt-4" (click)="removePersonToCall(i)"
                                    [disabled]="i==0">
                              Supprimer
                            </button>
                          </div>
                        </div>
                        <hr/>
                      </div>

                    </div>
                  </div>
                  <button [disabled]="personToCalls.length>=2" type="button"
                          class="btn btn-outline-success"
                          (click)="addPersonToCall()">Ajouter une personne
                  </button>
                </div>
              </div>
              <div class="d-grid gap-2 mt-4">
                <div class="row justify-content-end">
                  <div class="col-auto">
                  </div>
                  <div class="d-flex justify-content-end mt-3">
                    <button class="btn btn-outline-success me-2">Enregistrer</button>
                    <button class="btn btn-outline-secondary" (click)="toggleEditMembershipInfo()">Annuler</button>
                  </div>
                </div>
              </div>
            </form>
          </ng-template>
        </div>
      </div>

    </div>
  </div>

  <div class="mt-4 text-center">
    <button class="btn btn-danger" (click)="deleteProfile()">
      <i class="bi bi-trash"></i> Supprimer le profil
    </button>
  </div>
</div>
